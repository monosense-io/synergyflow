# Test Design: Story 16.07 — Frontend App Bootstrap (Next.js 14)

Date: 2025-09-18
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 20
- Unit tests: 9 (45%)
- Integration tests: 6 (30%)
- E2E tests: 5 (25%)
- Priority distribution: P0: 6, P1: 9, P2: 5

Stack: Vitest + React Testing Library for unit; Playwright for E2E. CI runs lint → type-check → unit → e2e.

## Test Scenarios by Acceptance Criteria

### AC1: Create Next.js 14 + TS5 app (strict, aliases)

| ID            | Level | Priority | Test                                                        | Justification                           |
| ------------- | ----- | -------- | ----------------------------------------------------------- | --------------------------------------- |
| 16.07-UNIT-001| Unit  | P1       | tsc runs with `strict: true` and no TS errors               | Type safety baseline                    |
| 16.07-INT-001 | Int   | P1       | Path aliases resolve in build and test                      | DX + reliability                        |
| 16.07-E2E-001 | E2E   | P2       | App starts, landing page loads 200                          | Smoke of scaffold                       |

### AC2: Tooling (ESLint, Prettier, scripts)

| ID            | Level | Priority | Test                                                        | Justification                           |
| ------------- | ----- | -------- | ----------------------------------------------------------- | --------------------------------------- |
| 16.07-UNIT-002| Unit  | P1       | ESLint runs with jsx-a11y plugin and 0 errors               | Lint coverage incl. a11y                |
| 16.07-UNIT-003| Unit  | P2       | Prettier format check passes on repo                        | Formatting baseline                     |
| 16.07-INT-002 | Int   | P1       | All package.json scripts exist and exit 0 in CI dry-run     | Deterministic DX                        |

### AC3: UI stack (Tailwind + shadcn/ui, theme + a11y)

| ID            | Level | Priority | Test                                                        | Justification                           |
| ------------- | ----- | -------- | ----------------------------------------------------------- | --------------------------------------- |
| 16.07-UNIT-004| Unit  | P1       | Theme toggle switches class on <html> and persists          | UI behavior + preference persistence    |
| 16.07-UNIT-005| Unit  | P1       | Keyboard focus styles visible on interactive elements       | A11y baseline                           |
| 16.07-INT-003 | Int   | P2       | Tailwind content globs include app/components/features      | Avoid purging required styles           |

### AC4: AuthN stub (NextAuth/OIDC), guards, env

| ID            | Level | Priority | Test                                                        | Justification                           |
| ------------- | ----- | -------- | ----------------------------------------------------------- | --------------------------------------- |
| 16.07-UNIT-006| Unit  | P0       | Env schema validates required keys (.env.example present)   | Prevent misconfig/secret leaks          |
| 16.07-INT-004 | Int   | P0       | Guard redirects unauthenticated to login route              | Security-critical path                  |
| 16.07-E2E-002 | E2E   | P0       | Auth flow stub completes; session indicator visible         | End-to-end auth baseline                |
| 16.07-E2E-003 | E2E   | P0       | Session cookie flags secure/sameSite in production mode     | Session hardening                       |

### AC5: App structure and protected route

| ID            | Level | Priority | Test                                                        | Justification                           |
| ------------- | ----- | -------- | ----------------------------------------------------------- | --------------------------------------- |
| 16.07-UNIT-007| Unit  | P2       | Directory structure present per source-tree                 | Project hygiene                         |
| 16.07-E2E-004 | E2E   | P1       | Visiting /protected unauth redirects to login              | Behavior contract                       |

### AC6: Data layer (TanStack Query + api-client)

| ID            | Level | Priority | Test                                                        | Justification                           |
| ------------- | ----- | -------- | ----------------------------------------------------------- | --------------------------------------- |
| 16.07-UNIT-008| Unit  | P1       | api-client applies interceptors, retries on 429, auth on 401| Robust data access patterns             |
| 16.07-INT-005 | Int   | P1       | Query client provider present; error boundary renders       | Integration of data layer               |

### AC7: i18n and preferences

| ID            | Level | Priority | Test                                                        | Justification                           |
| ------------- | ----- | -------- | ----------------------------------------------------------- | --------------------------------------- |
| 16.07-UNIT-009| Unit  | P2       | i18n loader returns localized strings; language switch works| Localization baseline                   |
| 16.07-INT-006 | Int   | P2       | Theme preference persisted (e.g., localStorage/cookie)      | Preference persistence                  |

### AC8: Testing ready (unit + E2E + CI)

| ID            | Level | Priority | Test                                                        | Justification                           |
| ------------- | ----- | -------- | ----------------------------------------------------------- | --------------------------------------- |
| 16.07-INT-007 | Int   | P1       | CI runs `lint`, `type-check`, `test`, `e2e` with artifacts  | CI flow correctness                     |
| 16.07-E2E-005 | E2E   | P0       | E2E suite stable with 1 retry + traces/video on failure     | CI reliability                          |

### AC9: README completeness

| ID            | Level | Priority | Test                                                        | Justification                           |
| ------------- | ----- | -------- | ----------------------------------------------------------- | --------------------------------------- |
| 16.07-INT-008 | Int   | P2       | README contains run/build/test/env/version policy sections  | Developer onboarding                    |

## Risk Coverage

- SEC-001 (Auth/session hardening): 16.07-UNIT-006, 16.07-E2E-002, 16.07-E2E-003
- OPS-001 (E2E flakiness): 16.07-E2E-005
- DATA-001 (Secrets handling): 16.07-UNIT-006
- TECH-001 (Bundle bloat): add build-size budget check (tracked under future ops) — enforce during CI with next build analyzer
- OPS-002 (Version mismatch): 16.07-INT-007 (engines pinning + CI)

## Recommended Execution Order

1. P0 Unit/Integration/E2E: 16.07-UNIT-006, 16.07-INT-004, 16.07-E2E-002, 16.07-E2E-003, 16.07-E2E-005
2. P1 set: 16.07-UNIT-001/002/004/005/008, 16.07-INT-001/002/005/007, 16.07-E2E-001/004
3. P2 set: remaining unit/integration

---

```yaml
test_design:
  scenarios_total: 20
  by_level:
    unit: 9
    integration: 6
    e2e: 5
  by_priority:
    p0: 6
    p1: 9
    p2: 5
  coverage_gaps: []
```

Trace references:

Test design matrix: docs/qa/assessments/16.07-test-design-20250918.md
P0 tests identified: 6
